<Window
    x:Class="XerahS.RegionCapture.UI.RegionCaptureOverlay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid" Background="Transparent" DoubleTapped="OnDoubleTapped">
        <!-- Freeze screen background -->
        <Image x:Name="BackgroundImage" Stretch="Fill" />

        <!-- Dim overlay covering entire virtual desktop -->
        <Rectangle x:Name="DimOverlay" Fill="Black" Opacity="0.5" />

        <!-- Selection rendering canvas -->
        <Canvas x:Name="SelectionCanvas" IsHitTestVisible="False">
            <!-- Window highlight border (when hovering over a window) -->
            <Rectangle x:Name="WindowHighlightRect"
                       Stroke="Cyan"
                       StrokeThickness="3"
                       Fill="Transparent"
                       Visibility="Collapsed"
                       Canvas.Left="0"
                       Canvas.Top="0"
                       Width="0"
                       Height="0">
                <Rectangle.StrokeDashArray>
                    <DoubleCollection>5,3</DoubleCollection>
                </Rectangle.StrokeDashArray>
            </Rectangle>

            <!-- Selection rectangle -->
            <Rectangle x:Name="SelectionRect"
                       Stroke="White"
                       StrokeThickness="2"
                       Fill="Transparent"
                       Visibility="Collapsed"
                       Canvas.Left="0"
                       Canvas.Top="0"
                       Width="0"
                       Height="0">
                <Rectangle.StrokeDashArray>
                    <DoubleCollection>5,3</DoubleCollection>
                </Rectangle.StrokeDashArray>
            </Rectangle>

            <!-- Crosshair lines -->
            <Line x:Name="CrosshairHorizontal"
                  Stroke="White"
                  StrokeThickness="1"
                  Opacity="0.5"
                  Visibility="Collapsed"
                  X1="0" Y1="0" X2="0" Y2="0" />

            <Line x:Name="CrosshairVertical"
                  Stroke="White"
                  StrokeThickness="1"
                  Opacity="0.5"
                  Visibility="Collapsed"
                  X1="0" Y1="0" X2="0" Y2="0" />

            <!-- Resize handles (shown when selection is active) -->
            <Ellipse x:Name="HandleTopLeft" Fill="White" Width="8" Height="8" Visibility="Collapsed" />
            <Ellipse x:Name="HandleTopRight" Fill="White" Width="8" Height="8" Visibility="Collapsed" />
            <Ellipse x:Name="HandleBottomLeft" Fill="White" Width="8" Height="8" Visibility="Collapsed" />
            <Ellipse x:Name="HandleBottomRight" Fill="White" Width="8" Height="8" Visibility="Collapsed" />
        </Canvas>

        <!-- Coordinate HUD -->
        <Border x:Name="CoordinateHUD"
                Background="#CC000000"
                BorderBrush="White"
                BorderThickness="1"
                CornerRadius="4"
                Padding="8,4"
                Visibility="Collapsed"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="10">
            <StackPanel Spacing="2">
                <TextBlock x:Name="HUDText"
                           Foreground="White"
                           FontFamily="Consolas"
                           FontSize="12"
                           Text="X: 0, Y: 0, W: 0, H: 0" />
                <TextBlock x:Name="HUDMonitorText"
                           Foreground="#AAAAAA"
                           FontFamily="Consolas"
                           FontSize="10"
                           Text="" />
            </StackPanel>
        </Border>

        <!-- Help text (shown initially) -->
        <Border x:Name="HelpOverlay"
                Background="#CC000000"
                BorderBrush="White"
                BorderThickness="1"
                CornerRadius="4"
                Padding="16"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <StackPanel Spacing="8">
                <TextBlock Foreground="White" FontSize="16" FontWeight="SemiBold" Text="Region Capture" HorizontalAlignment="Center" />
                <TextBlock Foreground="#CCCCCC" FontSize="12" TextWrapping="Wrap">
                    <Run Text="• Hover over a window to highlight, click to capture" /><LineBreak/>
                    <Run Text="• Drag to select a custom region" /><LineBreak/>
                    <Run Text="• Press Enter to confirm, Esc to cancel" /><LineBreak/>
                    <Run Text="• Use arrow keys to adjust selection" /><LineBreak/>
                    <Run Text="• Hold Shift for larger adjustments" />
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</Window>
